<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
   <head profile="http://gmpg.org/xfn/11">
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

      <link rel="stylesheet" type="text/css" href="bootstrap.css" rel="stylesheet">      
      <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js'></script>
      <script type='text/javascript' src='leaflet.js'></script>
      <script src="jquery.csv-0.71.js"></script>
      
   </head>
   
   <body>
      <h1>Sample</h1>
      
      <p></p>
      <div class = "row">
         <div class = "col-sm-3 center-block">

            <input type="range" min="0" max="50" value="0" step="5" onchange="showValue(this.value)" />
         </div>
         <div class = "col-sm-8 text-left">
            <div id="map" style="width: 600px; height: 800px; border: 1px solid #AAA;"></div>
            <script type='text/javascript'>
               var map = L.map( 'map', {
               center: [40.7613292,-73.9834088],
               zoom: 12
               });

               L.tileLayer( 'http://{s}.tiles.mapbox.com/v4/rcastellanes.d1bd2cf7/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoicmNhc3RlbGxhbmVzIiwiYSI6IkVRd0dDaVEifQ.EsWXaa4BxE2qtGQ658rXqQ', {
                  attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">MapBox</a>'
               }).addTo( map );

               // 
               var legendControl = new L.Control.Legend();
               legendControl.addTo(map);

               // Pulls data from the CSV
               $.get("datafile.csv", function(data) {
                   mapData(data);
               });

               function mapData(data) {
                  var dataset = $.csv.toObjects(data);
                  var datasetLength = dataset.length;
                  var marker;
                  for (var i = 0; i < datasetLength; i++) {
                     var currentDataPoint = dataset[i];


                  // sets data points
                     var options = {
                        data: {
                           'WeightedScore': currentDataPoint.subway,
                        },
                        chartOptions: {
                           'WeightedScore': {
                              fillColor: '#5DA5DA',
                              gradient: false,
                              minValue: 0,
                              maxValue: 100,
                              maxHeight: 100,
                              displayText: function (value) {
                                 return value.toFixed(0);
                              }
                           },
                        weight: 1,
                        color: '#000000'
                        }
                     }
                     // sets data points to block centers
                     marker = new L.BarChartMarker(new L.LatLng(currentDataPoint.YCoord,currentDataPoint.XCoord), options);
                     map.addLayer(marker);
                  }
               }
            </script>
         </div>
      </div>
   </body>
</html>